<div class="d-flex flex-row justify-content-end mx-2 mx-md-5">
    <button (click)="newSubscription()" class="btn px-3 py-2 my-3 mx-3"
        style="background-color: #f8c075; font-weight: 600; border-radius: 2rem;" data-bs-toggle="modal"
        data-bs-target="#uniqueLabelModal"> +
        New</button>
</div>

<div class="row row-cols-lg-2 row-cols-md-2 row-cols-1  row-cols-xl-5 g-4 mx-5">
    @for(sub of subscriptionTypes;track sub.name){
    <div class="col">
        <div (click)="subSelect(sub)" class="card"
            [ngStyle]="{'border':'0.3rem solid','border-color':sub.color , 'background-color':selectSub.name == sub.name ? selectSub.color : ''}"
            style="border-radius: 2rem; font-weight: 600; cursor: pointer;">
            <div class="card-body">
                <div class="card-title text-center">
                    {{sub.name}}
                </div>
            </div>
        </div>
    </div>
    }
</div>

@for(sub of subscriptionTypes;track sub.name){
<div class="row row-cols-1 row-cols-xl-2 mx-xl-5 mx-2 my-3" *ngIf="sub.name == selectSub.name">
    <div class="col mb-3">
        <div class="card" style="border: none;border-radius: 1rem;">
            <div class="my-4 mx-2">
                <span class="text col-lg-6 p-4" style="font-weight: bold;">
                    Total Paid Subscriptions
                </span>
                <div>
                    <div class="text-center my-4">
                        <i class="bi bi-arrow-up-circle p-3" style="border-radius: 50%;background-color: #dffff3;"></i>
                        <span style="font-weight: bold;" class="mx-2">
                            {{sub.totalSub.amount}}
                        </span>
                    </div>
                </div>

                <div class="d-flex flex-row justify-content-between px-2">
                    <div class="">
                        <i class="bi bi-sliders2-vertical p-3"
                            style="border-radius: 50%;background-color: #fff6ea;"></i>
                        <span style="font-weight: bold;" class="mx-2">
                            {{sub.totalSub.sub}}
                        </span>
                        <div style=" color: grey;" class="mt-1 mx-5">
                            Subscriptions
                        </div>
                    </div>
                    <div class="">
                        <i class="bi bi-people p-3" style="border-radius: 50%;background-color: #e1f5fa;"></i>
                        <span style="font-weight: bold;" class="mx-2">
                            {{sub.totalSub.users}}
                        </span>
                        <div style=" color: grey;" class="mt-1 mx-5">
                            Users
                        </div>
                    </div>
                </div>

            </div>
        </div>

    </div>
    <div class="col">
        <div class="card" style="border: none;border-radius: 1rem;">
            <div class="my-4 mx-2">
                <span class="text col-lg-6 p-4" style="font-weight: bold;">
                    New Subscriptions Activations
                </span>
                <div>
                    <div class="text-center my-4">
                        <i class="bi bi-arrow-up-circle p-3" style="border-radius: 50%;background-color: #dffff3;"></i>
                        <span style="font-weight: bold;" class="mx-2">
                            {{sub.newSub.amount}}
                        </span>
                    </div>
                </div>

                <div class="d-flex flex-row justify-content-between px-2">
                    <div class="">
                        <i class="bi bi-sliders2-vertical p-3"
                            style="border-radius: 50%;background-color: #fff6ea;"></i>
                        <span style="font-weight: bold;" class="mx-2">
                            {{sub.newSub.sub}}
                        </span>
                        <div style=" color: grey;" class="mt-1 mx-5">
                            Subscriptions
                        </div>
                    </div>
                    <div class="">
                        <i class="bi bi-people p-3" style="border-radius: 50%;background-color: #e1f5fa;"></i>
                        <span style="font-weight: bold;" class="mx-2">
                            {{sub.newSub.users}}
                        </span>
                        <div style=" color: grey;" class="mt-1 mx-5">
                            Users
                        </div>
                    </div>
                </div>

            </div>
        </div>

    </div>
</div>
}

<div class="row row-cols-1 mx-xxl-5 mx-2 mt-4 d-none d-xl-block filter">
    <div class="col">
        <div (click)="openSearch()" class="mt-4 py-3 mx-3" style="cursor: pointer;">
            <i class="bi bi-search mx-3" style="-webkit-text-stroke: 1px;"></i> Search Here:
        </div>
        <div [ngClass]="isSearch ? 'd-block' : 'd-none'">
            <!-- <form [formGroup]="searchForm" (ngSubmit)="onSubmit()" class="my-4">
                                    <div class="row row-cols-3 g-3">

                                        <div class="col">
                                            <div class="mt-3">

                                                <div class="input-group mb-3 search-bar">
                                                    <span class="input-group-text search-icon"
                                                        id="companyName-addon">Company Name</span>
                                                    <input type="text" class="form-control search"
                                                        formControlName="companyName"
                                                        aria-describedby="companyName-addon">
                                                </div>

                                            </div>
                                        </div>

                                        <div class="col">
                                            <div class="mt-3">

                                                <div class="input-group mb-3 search-bar">
                                                    <span class="input-group-text search-icon"
                                                        id="email-addon">Email</span>
                                                    <input type="email" class="form-control search"
                                                        formControlName="email" aria-describedby="email-addon">
                                                </div>

                                            </div>
                                        </div>

                                        <div class="col">
                                            <div class=" mt-3">
                                                <div class="input-group mb-3 search-bar">
                                                    <span class="input-group-text search-icon"
                                                        id="mobile-addon">Mobile</span>
                                                    <input type="tel" class="form-control search"
                                                        formControlName="mobile" aria-describedby="mobile-addon">
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col">
                                            <div class="mx-1 mt-3">

                                                <div class="input-group mb-3 search-bar">
                                                    <span class="input-group-text search-icon"
                                                        id="resellerType-addon">Reseller Type</span>
                                                    <input type="text" class="form-control search"
                                                        formControlName="resellerType"
                                                        aria-describedby="resellerType-addon">
                                                </div>

                                            </div>
                                        </div>

                                        <div class="col">
                                            <div class="mx-1 mt-3 ">

                                                <div class="input-group mb-3 search-bar">
                                                    <span class="input-group-text search-icon"
                                                        id="registrationDateFrom-addon">Registration Date
                                                        From</span>
                                                    <input type="date" class="form-control search"
                                                        formControlName="registrationDateFrom"
                                                        aria-describedby="registrationDateFrom-addon">
                                                </div>

                                            </div>
                                        </div>

                                        <div class="col">
                                            <div class="mx-1 mt-3 ">

                                                <div class="input-group mb-3 search-bar">
                                                    <span class="input-group-text search-icon"
                                                        id="registrationDateTo-addon">Registration Date
                                                        To</span>
                                                    <input type="date" class="form-control search"
                                                        formControlName="registrationDateTo"
                                                        aria-describedby="registrationDateTo-addon">
                                                </div>

                                            </div>
                                        </div>

                                        <div class="col">
                                            <div class="mx-1 mt-3 ">

                                                <div class="input-group mb-3 search-bar">
                                                    <span class="input-group-text search-icon"
                                                        id="noOfAccountsFrom-addon">No. of Accounts
                                                        From</span>
                                                    <input type="number" class="form-control search"
                                                        formControlName="noOfAccountsFrom"
                                                        aria-describedby="noOfAccountsFrom-addon">
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col">
                                            <div class="mx-1 mt-3 ">
                                                <div class="input-group mb-3 search-bar">
                                                    <span class="input-group-text search-icon"
                                                        id="noOfAccountsTo-addon">No. of Accounts To</span>
                                                    <input type="number" class="form-control search"
                                                        formControlName="noOfAccountsTo"
                                                        aria-describedby="noOfAccountsTo-addon">
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col">
                                            <div class="mx-1 mt-3 ">
                                                <div class="input-group mb-3 search-bar">
                                                    <span class="input-group-text search-icon"
                                                        id="creditFrom-addon">Credit From</span>
                                                    <input type="number" class="form-control search"
                                                        formControlName="creditFrom"
                                                        aria-describedby="creditFrom-addon">
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col">
                                            <div class="mx-1 mt-3 ">
                                                <div class="input-group mb-3 search-bar">
                                                    <span class="input-group-text search-icon"
                                                        id="creditTo-addon">Credit To</span>
                                                    <input type="number" class="form-control search"
                                                        formControlName="creditTo" aria-describedby="creditTo-addon">
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col">
                                            <div class="mx-1 mt-3 ">
                                                <div class="input-group mb-3 search-bar">
                                                    <span class="input-group-text search-icon"
                                                        id="label-addon">Label</span>
                                                    <select class="form-control search" formControlName="label"
                                                        aria-describedby="label-addon">
                                                        <option value="">Please Select</option>
                                                        <option value>{{label}}</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col">
                                            <div class="mx-1 mt-3 ">
                                                <div class="input-group mb-3 search-bar">
                                                    <span class="input-group-text search-icon"
                                                        id="accountManager-addon">Account Manager</span>
                                                    <select class="form-control search" formControlName="accountManager"
                                                        aria-describedby="accountManager-addon">
                                                        <option value="">Please Select</option>
                                                        <option *ngFor="let accountManager of accountManagers"
                                                            [ngValue]="accountManager">
                                                            {{accountManager}}</option>

                                                    </select>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col">
                                            <div class="mx-1 mt-3 ">
                                                <div class="input-group mb-3 search-bar">
                                                    <span class="input-group-text search-icon"
                                                        id="status-addon">Status</span>
                                                    <select class="form-control search" formControlName="status"
                                                        aria-describedby="status-addon">
                                                        <option value="All">All</option>
                                                        <option *ngFor="let item of status" [ngValue]="item">{{item}}
                                                        </option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="d-flex flex-row justify-content-end">
                                        <button class="btn my-3 search-btn mx-2 ">Search</button>
                                        <button (click)="resetFilters()" class="btn my-3 reset-btn mx-2 ">Reset
                                            Filter</button>

                                    </div>
                                </form> -->
            <form [formGroup]="searchForm" (ngSubmit)="onSubmit()" class="">
                <div class="row row-cols-md-3 row-cols-1 mx-5 my-1 g-md-4 g-0">

                    <!-- Start Date Field -->
                    <div class="col mb-3">
                        <label for="startDate" class="form-label">Start Date</label>
                        <input id="startDate" type="date" class="form-control" formControlName="startDate">
                    </div>

                    <!-- Next Billing Date Field -->
                    <div class="col mb-3">
                        <label for="nextBillingDate" class="form-label">Next Billing Date</label>
                        <input id="nextBillingDate" type="date" class="form-control" formControlName="nextBillingDate">
                    </div>

                    <!-- Last Billing Date Field -->
                    <div class="col mb-3">
                        <label for="lastBillingDate" class="form-label">Last Billing Date</label>
                        <input id="lastBillingDate" type="date" class="form-control" formControlName="lastBillingDate">
                    </div>

                    <!-- Company/Email Address Field -->
                    <div class="col mb-3">
                        <label for="companyEmailAddress" class="form-label">Company/Email
                            Address</label>
                        <input id="companyEmailAddress" type="text" class="form-control"
                            formControlName="companyEmailAddress">
                    </div>

                    <!-- SubCode Field -->
                    <div class="col mb-3">
                        <label for="subCode" class="form-label">SubCode</label>
                        <input id="subCode" type="text" class="form-control" formControlName="subCode">
                    </div>

                    <!-- Status Field -->
                    <div class="col mb-3">
                        <label for="status" class="form-label">Status</label>
                        <select id="status" class="form-select" formControlName="status">
                            <option value="">Select Status</option>
                            <option value="active">Active</option>
                            <option value="suspend">Suspend</option>
                        </select>
                    </div>

                    <!-- Stage Field -->
                    <div class="col mb-3">
                        <label for="stage" class="form-label">Stage</label>
                        <div class="dropdown" #stageContainer id="stage">
                            <button (click)="openDropdown('stage')" class="btn d-flex flex-row justify-content-between"
                                type="button" [ngStyle]="{'width': '100%'}"
                                style="border: 1px solid rgb(233, 233, 233); overflow: hidden; height: 2.3rem;">
                                {{ getSelectedValues('stage') }}
                                <i class="bi bi-chevron-down"></i>
                            </button>
                            <div class="dropdown-container" aria-labelledby="dropdownMenuButton"
                                [ngClass]="dropdownType === 'stage' ? 'd-block' : 'd-none'">
                                <div class="px-1">
                                    <div class="form-check d-flex flex-row justify-content-start pt-1"
                                        style="height: 3rem; cursor: pointer; border-bottom: 0.1rem solid rgb(243, 243, 243);">
                                        <input class="form-check-input" type="checkbox" id="stageSelectAll"
                                            value="Select All" (change)="onMultiSelectChange($event, 'stage', stages)">
                                        <label class="form-check-label px-3" for="stageSelectAll"
                                            style="width: 100%;">Select All</label>
                                    </div>
                                </div>
                                <div *ngFor="let stage of stages" class="px-1">
                                    <div class="form-check d-flex flex-row justify-content-start pt-1"
                                        style="height: 3rem; cursor: pointer; border-bottom: 0.1rem solid rgb(243, 243, 243);">
                                        <input class="form-check-input" type="checkbox" [id]="stage" [value]="stage"
                                            (change)="onMultiSelectChange($event, 'stage', stages)" [name]="'stage'">
                                        <label class="form-check-label px-3" [for]="stage" style="width: 100%;">{{ stage
                                            }}</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Plan Name Field -->
                    <div class="col mb-3">
                        <label for="plan" class="form-label">Plan</label>
                        <div class="dropdown" #planContainer id="plan">
                            <button (click)="openDropdown('plan')" class="btn d-flex flex-row justify-content-between"
                                type="button" [ngStyle]="{'width': '100%'}"
                                style="border: 1px solid rgb(233, 233, 233);overflow: hidden; height: 2.3rem;">
                                {{ getSelectedValues('plan') }}
                                <i class="bi bi-chevron-down"></i>
                            </button>
                            <div class="dropdown-container" aria-labelledby="dropdownMenuButton"
                                [ngClass]="dropdownType === 'plan' ? 'd-block' : 'd-none'"
                                style="height: 20rem; overflow-y: scroll;">
                                <div class="px-1">
                                    <div class="form-check d-flex flex-row justify-content-start pt-1"
                                        style="height: 3rem; cursor: pointer; border-bottom: 0.1rem solid rgb(243, 243, 243);">
                                        <input class="form-check-input" type="checkbox" id="planSelectAll"
                                            value="Select All" (change)="onMultiSelectChange($event, 'plan', plans)">
                                        <label class="form-check-label px-3" for="planSelectAll"
                                            style="width: 100%;">Select All</label>
                                    </div>
                                </div>
                                <div *ngFor="let plan of plans" class="px-1">
                                    <div class="form-check d-flex flex-row justify-content-start pt-1"
                                        style="height: 3rem; cursor: pointer; border-bottom: 0.1rem solid rgb(243, 243, 243);">
                                        <input class="form-check-input" type="checkbox" [id]="plan" [value]="plan"
                                            (change)="onMultiSelectChange($event, 'plan', plans)" [name]="'plan'">
                                        <label class="form-check-label px-3" [for]="plan" style="width: 100%;">{{ plan
                                            }}</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>


                    <!-- Partner Field -->
                    <div class="col mb-3">
                        <label for="partner" class="form-label">Partner</label>
                        <div class="dropdown" #partnerContainer id="partner">
                            <button (click)="openDropdown('partner')"
                                class="btn d-flex flex-row justify-content-between" type="button"
                                [ngStyle]="{'width': '100%'}"
                                style="border: 1px solid rgb(233, 233, 233); overflow: hidden; height: 2.3rem;">
                                {{ getSelectedValues('partner') }}
                                <i class="bi bi-chevron-down"></i>
                            </button>
                            <div class="dropdown-container" aria-labelledby="dropdownMenuButton"
                                [ngClass]="dropdownType === 'partner' ? 'd-block' : 'd-none'"
                                style="height: 20rem; overflow-y: scroll;">
                                <div class="px-1">
                                    <div class="form-check d-flex flex-row justify-content-start pt-1"
                                        style="height: 3rem; cursor: pointer; border-bottom: 0.1rem solid rgb(243, 243, 243);">
                                        <input class="form-check-input" type="checkbox" id="partnerSelectAll"
                                            value="Select All"
                                            (change)="onMultiSelectChange($event, 'partner', partners)">
                                        <label class="form-check-label px-3" for="partnerSelectAll"
                                            style="width: 100%;">Select All</label>
                                    </div>
                                </div>
                                <div *ngFor="let partner of partners" class="px-1">
                                    <div class="form-check d-flex flex-row justify-content-start pt-1"
                                        style="height: 3rem; cursor: pointer; border-bottom: 0.1rem solid rgb(243, 243, 243);">
                                        <input class="form-check-input" type="checkbox" [id]="partner" [value]="partner"
                                            (change)="onMultiSelectChange($event, 'partner', partners)"
                                            [name]="'partner'">
                                        <label class="form-check-label px-3" [for]="partner" style="width: 100%;">{{
                                            partner }}</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Account Manager Field -->
                    <div class="col mb-3">
                        <label for="accountManager" class="form-label">Account Manager</label>
                        <div class="dropdown" #accountManagerContainer id="accountManager">
                            <button (click)="openDropdown('accountManager')"
                                class="btn d-flex flex-row justify-content-between" type="button"
                                [ngStyle]="{'width': '100%'}"
                                style="border: 1px solid rgb(233, 233, 233); overflow: hidden; height: 2.3rem;">
                                {{ getSelectedValues('accountManager') }}
                                <i class="bi bi-chevron-down"></i>
                            </button>
                            <div class="dropdown-container" aria-labelledby="dropdownMenuButton"
                                [ngClass]="dropdownType === 'accountManager' ? 'd-block' : 'd-none'"
                                style="height: 20rem; overflow-y: scroll;">
                                <div class="px-1">
                                    <div class="form-check d-flex flex-row justify-content-start pt-1"
                                        style="height: 3rem; cursor: pointer; border-bottom: 0.1rem solid rgb(243, 243, 243);">
                                        <input class="form-check-input" type="checkbox" id="accountManagerSelectAll"
                                            value="Select All"
                                            (change)="onMultiSelectChange($event, 'accountManager', accountManagers)">
                                        <label class="form-check-label px-3" for="accountManagerSelectAll"
                                            style="width: 100%;">Select All</label>
                                    </div>
                                </div>
                                <div *ngFor="let accountManager of accountManagers" class="px-1">
                                    <div class="form-check d-flex flex-row justify-content-start pt-1"
                                        style="height: 3rem; cursor: pointer; border-bottom: 0.1rem solid rgb(243, 243, 243);">
                                        <input class="form-check-input" type="checkbox" [id]="accountManager"
                                            [value]="accountManager"
                                            (change)="onMultiSelectChange($event, 'accountManager', accountManagers)"
                                            [name]="'accountManager'">
                                        <label class="form-check-label px-3" [for]="accountManager"
                                            style="width: 100%;">{{ accountManager }}</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Activate Field -->
                    <div class="col mb-3">
                        <label for="activate" class="form-label">Activate</label>
                        <select id="activate" class="form-select" formControlName="activate">
                            <option value="">Select Activation Status</option>
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                            <!-- Add other activation statuses as needed -->
                        </select>
                    </div>

                    <!-- Tally Serial No Field -->
                    <div class="col mb-3">
                        <label for="tallySerialNo" class="form-label">Tally Serial No</label>
                        <input id="tallySerialNo" type="text" class="form-control" formControlName="tallySerialNo">
                    </div>

                </div>

                <div class="d-flex flex-row justify-content-end">
                    <button type="submit" class="btn btn-primary my-3 mx-3" style="border-radius: 2rem;">Search</button>
                    <button (click)="resetForm()" type="submit" class="btn btn-secondary my-3"
                        style="border-radius: 2rem;">Reset</button>
                </div>
            </form>


        </div>


    </div>

</div>
<!--- Table HTML -->
<div class=" mx-xxl-5 mx-2 my-3 p-4" style="background-color: white; border-radius: 1rem; overflow:hidden">
    <app-table [data]="subData" [columns]="columnName"></app-table>
</div>



<!-- <div class="modal fade" id="uniqueLabelModal" tabindex="-1" aria-labelledby="labelModalLabel" aria-hidden="true">
    <app-tally-release-modal [isEdit]="isEdit" [editData]="newData"></app-tally-release-modal>
</div> -->